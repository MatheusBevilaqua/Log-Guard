<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LogGuard - Dashboard</title>
    <link rel="stylesheet" href="./css/main.css">
    <link rel="shortcut icon" type="imagex/png" href="./img/logo_vetorizada6.png">
</head>

<body onload="verUsuarios(); totalfunc(); totaladms(); totalanalista(); verMaquinas()">
    <section class="page-dash">
        <aside class="nav-dash">
            <div class="nav-dash-logo">
                <img src="./svg/iceberg-preto-com-texto.svg" class="nav-dash-logo" alt="Logo LogGuard">
            </div>
            <ul class="nav-dash-list">
                <a href="dashboard_ADM.html">
                <li class="nav-dash-link" href=""><img src="./svg/key-icon.svg" class="nav-dash-icon" style="padding-left: 3%;">Visão
                        Geral</li>
                </a>
                <a href="relatorios.html">
                <li class="nav-dash-link"><img src="./img/icon-cnpj.png" class="nav-dash-icon" style="padding-left: 3%;">Relatórios
                    </li>
                </a>
                <a href="gerenciar-maquina.html">
                <li class="nav-dash-link"><img src="./img/monitor.svg" class="nav-dash-icon" style="padding-left: 3%;">Máquinas</li>
                </a>
                <a href="gerenciar-usuario-func.html">
                    <li class="nav-dash-link"><img src="./img/icon-man.png" class="nav-dash-icon">Funcionários</li>
                </a>
                <a href="index.html">
                <li class="nav-dash-link-sair"><img src="./img/sair.png" class="nav-dash-icon" style="padding-left: 3%;">Sair</li>
                </a>
            </ul>
            </nav>
            </nav>
        </aside>
        <section class="page-dash-func">

            <div class="mainfuncpage">
                <h1>Gerenciar Usuários:</h1>
                <div class="select-func">
                    <select id="selectgerenciarusuario" name="select">
                        <div class="select-items-func">
                            <option value="valor1" selected>Mostrar todos</option>
                            <option value="valor2">ADM</option>
                            <option value="valor3">Analista</option>
                        </div>
                    </select>
                </div>
                <div class="metricas-func">
                    <div class="dash-func">
                        <div class="titulos-func">
                            <div class="coluna-func">ID</div>
                            <div class="coluna-func">Nome</div>
                            <div class="coluna-func">E-Mail</div>
                            <div class="coluna-func">Cargo</div>
                        </div>
                        <div class="linha-func">
                            <img src="./img/Line1cadastro.png" alt="">
                        </div>


                        <div class="dash-func">
                            <div id="dash-func"></div>
                        </div>
                    </div>
                    <div class="tre-func">
                        <div class="me1-func">
                            <h5>Total de funcionários:</h5>
                            <br><br>
                            <div class="totalfuncs" id="totalfuncionarios"></div>
                            <div class="me2-func">
                                <h5>Administradores:</h5>
                                <br>
                                <div class="totalfuncs" id="totaladms">0</div>

                                <div class="me3-func">
                                    <h5>Analistas:</h5>
                                    <br><br>
                                    <div class="totalfuncs" id="totalanalista">0</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="botoes-func">
                    <!-- <button onclick="editar_gefunc()" class="edit-func">Editar</button> -->
                    <button onclick="cadastrar_gefunc()" class="cad-func">Cadastrar</button>
                </div>

                <div class="duvidas-func">
                    <a href="./relatorios.html">Duvidas? Clique aqui!</a>
                </div>
            </div>


            <!-- EDITAR FUNCIONÁRIO ----------------------------------------------------------------------------------- -->
            <div class="Editarfunc">
                <div class="Editar-func-primeiro">
                    <h1>Alterar as configurações do perfil:</h1>
                    <input placeholder="Nome Completo" type="text" id="input_alterar_nome">
                    <img src="./img/Line1cadastro.png" alt="">
                    <input placeholder="E-Mail" type="text" id="input_alterar_email">
                    <img src="./img/Line1cadastro.png" alt="">
                    <div class="select-func-primeiro">
                        <select id="select_alterar_cargo">
                            <option value="" disabled>Selecionar cargo</option>
                            <option value="COMUM">COMUM</option>
                            <option value="ADMINISTRADOR">ADMINISTRADOR</option>
                        </select>

                    </div>
                    <img src="./img/Line1cadastro.png" alt="">
                    <input placeholder="Senha" type="text" id="input_alterar_senha">
                    <img src="./img/Line1cadastro.png" alt="">

                </div>
                <div class="editar-func-titulodelet">
                </div>
                <div class="Editar-func-botao-editar">
                    <button onclick="atribuicao_maquina_gefunc()" class="editar-func">Atribuição de Máquinas</button>
                </div>
                <img src="./img/Line1cadastro.png" class="linhacad">
                <div class="Editar-func-botao-delete">
                    <button onclick="atribuicao_editar_gefunc()" class="editar-func">Editar Perfil</button>
                    <button onclick="excluir_editar_gefunc()" class="excluir-func">Excluir Perfil</button>
                </div>
                <img src="./img/Line1cadastro.png" class="linhacad2">
                <div class="Editar-func-botao-fechar">
                    <button onclick="fechar_gefunc()" class="fechar-func">Fechar</button>
                </div>
            </div>
            <!-- FIM EDITAR FUNCIONÁRIO ----------------------------------------------------------------------------------- -->
            <div class="Cadastrarfunc">
                <h1>Complete os campos:</h1>
                <div class="cadastrar-func-primeiro">
                    <input placeholder="Nome" type="text" id="input_nome_func">
                    <img src="./img/Line1cadastro.png" alt="">
                    <input placeholder="E-Mail" type="text" id="input_email_func">
                    <img src="./img/Line1cadastro.png" alt="">
                    <div class="select-func-segundo">
                        <select id="lista_cargo" name="select">
                            <option value="" selected disabled>Selecionar cargo</option>
                            <option value="COMUM">COMUM</option>
                            <option value="ADMINISTRADOR">ADMINISTRADOR</option>
                        </select>
                    </div>
                    <img src="./img/Line1cadastro.png" alt="">
                    <input placeholder="Senha" type="text" id="input_senha_func">
                    <img src="./img/Line1cadastro.png" alt="">
                    <input placeholder="Repetir Senha" type="text" id="input_repetir_func">
                    <img src="./img/Line1cadastro.png" alt="">
                    <br>
                </div>
                <div class="cadastrar-func-terceiro">
                    <button onclick="confirmar_cadastrar_gefunc()" class="confirmar-func">Confirmar</button>
                    <button onclick="cancelar_cadastrar_gefunc()" class="cancelar-func">Cancelar</button>
                </div>
            </div>

            <div class="Editaratribuicaofunc">
                <h1>Editar atribuição de servidores</h1>
                <div class="dash-func-atribuicao">
                    <div class="titulos-func-atribuicao">
                        <div class="coluna-func">ID</div>
                        <div class="coluna-func">Máquina</div>
                        <div class="coluna-func">Localidade</div>
                    </div>
                    <div class="linha-func">
                        <img src="./img/Line1cadastro.png" alt="">
                    </div>
                    <div id="func-dados-atribuicao" class="func-dados-atribuicao">
                    </div>
                </div>
                <div class="cadastrar-func-a03">
                    <div class="criacaocheck">
                        <input type="checkbox" id="input_criacao">
                        <label for="input_criacao">Confirmar criação</label>
                    </div>
                    <div class="confirmar-func">
                        <button onclick="confirmar_check_func()" class="confirmar-func-a03">Confirmar</button>
                    </div>
                    <div class="confirmar-func">
                        <button onclick="cancelar_check_func()" class="cancelar-func-a03">Cancelar</button>
                    </div>
                </div>
            </div>

        </section>
</body>

</html>

<script>

    var idEmpresaUsuario = sessionStorage.EMPRESA_USUARIO
    var idUsuario = "";

    function confirmar_editar_gefunc() {
        // temporario
        document.querySelector('.mainfuncpage').style.filter = "blur(0px)";
        document.querySelector('.Editarfunc').style.display = "none";
    }

    function cancelar_editar_gefunc() {
        // temporario
        document.querySelector('.mainfuncpage').style.filter = "blur(0px)";
        document.querySelector('.Editarfunc').style.display = "none";
    }

    function excluir_editar_gefunc() {
        var r = confirm("Tem certeza que deseja excluir este perfil?");
        if (r == true) {
            if (idUsuario != sessionStorage.ID_USUARIO) {
                deletarUsuario();
                window.location.reload(true);
            } else {
                alert("Não é possivel deletar o seu usuário!")
            }
        }
    }

    function confirmar_cadastrar_gefunc() {
        cadastrarUsuario()
        window.location.reload(true);
    }


    function cancelar_cadastrar_gefunc() {
        // temporario
        document.querySelector('.mainfuncpage').style.filter = "blur(0px)";
        document.querySelector('.Cadastrarfunc').style.display = "none";
    }

    function editar_gefunc() {
        // temporario
        document.querySelector('.mainfuncpage').style.filter = "blur(5px)";
        document.querySelector('.Editarfunc').style.display = "block";

    }

    function cadastrar_gefunc() {
        document.querySelector('.mainfuncpage').style.filter = "blur(5px)";
        document.querySelector('.Cadastrarfunc').style.display = "block";

    }

    function fechar_gefunc() {
        document.querySelector('.mainfuncpage').style.filter = "blur(0px)";
        document.querySelector('.Editarfunc').style.display = "none";
    }

    function atribuicao_editar_gefunc() {
        var r = confirm("Tem certeza que deseja alterar este perfil?");
        if (r == true) {
            editarusuario();
        } else {
            alert("Algo deu errado na alteração de perfil!");
        }
    }

    function atribuicao_maquina_gefunc() {
        document.querySelector('.Editarfunc').style.filter = "blur(5px)";
        document.querySelector('.Editaratribuicaofunc').style.display = "block";
    }


    function cancelar_check_func() {
        document.querySelector('.Editarfunc').style.filter = "blur(0px)";
        document.querySelector('.Editaratribuicaofunc').style.display = "none";
    }

    function confirmar_check_func() {
        window.location.reload(true);
    }

    document.querySelectorAll('.dados-func-atribuicao').forEach(div => {
        div.addEventListener('click', () => {
            var checkbox = div.querySelector('input[type="checkbox"]');
            if (checkbox) {
                checkbox.checked = !checkbox.checked;
                if (checkbox.checked) {
                    div.style.backgroundColor = '#E3E3E3';
                } else {
                    div.style.backgroundColor = '';
                }
            }
        });
    });

    function limparListaUsuarios() {
        var lista = document.getElementById("dash-func");
        lista.innerHTML = '';
    }


    var selectgerenciarusuario = document.getElementById('selectgerenciarusuario');

    selectgerenciarusuario.addEventListener('change', function () {
        limparListaUsuarios();
        if (this.value === 'valor2') {
            filtrarADM()
        } else if (this.value === 'valor3') {
            filtrarComum()
        } else {
            verUsuarios()
        }
    });


    function verUsuarios() {
        fetch("/usuarios/visualizarUsuarios", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({
                idEmpresaUsuarioServer: idEmpresaUsuario
            }),
        })
            .then(function (resposta) {
                console.log("resposta: ", resposta);

                if (resposta.ok) {

                    if (resposta.status == 204) {
                        var lista = document.getElementById("dash-func");
                        var mensagem = document.createElement("span");
                        mensagem.innerHTML = "Nenhuma empresa encontrada."
                        lista.appendChild(mensagem);
                        throw "Nenhuma resultada encontrada!!";
                    }

                    resposta.json().then(function (resposta) {
                        console.log("Dados recebidos: ", JSON.stringify(resposta));

                        var lista = document.getElementById("dash-func");


                        for (let i = 0; i < resposta.length; i++) {

                            let tupla = resposta[i];
                            var divLista = document.createElement("div");
                            var divId = document.createElement("div");
                            var divnome = document.createElement("div");
                            var divEmail = document.createElement("div");
                            var divCargo = document.createElement("div");

                            divLista.className = "dados-func";
                            divId.className = "coluna-func";
                            divnome.className = "coluna-func";
                            divEmail.className = "coluna-func";
                            divCargo.className = "coluna-func";

                            divId.innerHTML = tupla.idUsuario;
                            divnome.innerHTML = tupla.nomeUsuario;
                            divEmail.innerHTML = tupla.emailUsuario;
                            divCargo.innerHTML = tupla.tipoPerfilUsuario;

                            divLista.appendChild(divId);
                            divLista.appendChild(divnome);
                            divLista.appendChild(divEmail);
                            divLista.appendChild(divCargo);
                            lista.appendChild(divLista);


                            let debounceTimeout;
                            divLista.addEventListener("click", function () {
                                if (debounceTimeout) {
                                    clearTimeout(debounceTimeout);
                                }

                                debounceTimeout = setTimeout(function () {
                                    gerenciarUsuario(tupla.idUsuario);
                                }, 200);
                            });

                            lista.appendChild(divLista);
                        }

                    });
                } else {
                    throw ('Houve um erro na API!');
                }
            }).catch(function (resposta) {
                console.error(resposta);
            });
    }


    function verMaquinas() {
        fetch("/usuarios/visualizarMaquinas", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({
                idEmpresaUsuarioServer: idEmpresaUsuario
            }),
        })
            .then(function (resposta) {
                console.log("resposta: ", resposta);
                if (resposta.ok) {
                    if (resposta.status == 204) {
                        var lista = document.getElementById("func-dados-atribuicao");
                        var mensagem = document.createElement("span");
                        mensagem.innerHTML = "Nenhuma máquina encontrada.";

                        

                        lista.appendChild(mensagem);
                        throw "Nenhum resultado encontrado!!";
                    }
                    resposta.json().then(function (resposta) {
                        console.log("Dados recebidos: ", JSON.stringify(resposta));
                        var lista = document.getElementById("func-dados-atribuicao");
                        lista.innerHTML = '';
                        for (let i = 0; i < resposta.length; i++) {
                            let tupla = resposta[i];
                            var divLista = document.createElement("div");
                            var checkbox = document.createElement("input");
                            var divId = document.createElement("div");
                            var divMaquina = document.createElement("div");
                            var divLocalidade = document.createElement("div");

                            divLista.className = "dados-func-atribuicao";
                            checkbox.type = "checkbox";
                            checkbox.id = "input_cadastro_checkbox";
                            checkbox.value = tupla.idMaquina;
                            divId.className = "coluna-func-atribuicao";
                            divMaquina.className = "coluna-func-atribuicao";
                            divLocalidade.className = "coluna-func-atribuicao";

                            divId.innerHTML = tupla.idMaquina;
                            divMaquina.innerHTML = tupla.nomeMaquina;
                            divLocalidade.innerHTML = tupla.localidade;

                            divLista.appendChild(checkbox);
                            divLista.appendChild(divId);
                            divLista.appendChild(divMaquina);
                            divLista.appendChild(divLocalidade);
                            let debounceTimeout;
                            divLista.addEventListener("click", function () {
                                if (debounceTimeout) {
                                    clearTimeout(debounceTimeout);
                                }

                                debounceTimeout = setTimeout(function () {
                                    alert(input_cadastro_checkbox.value);
                                }, 200);
                            });
                            lista.appendChild(divLista);

                            lista.value = tupla.idMaquina;

                        }
                    });
                } else {
                    throw ('Houve um erro na API!');
                }
            }).catch(function (resposta) {
                console.error(resposta);
            });
    }


    function filtrarADM() {
        fetch("/usuarios/visualizarUsuariosADM", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({
                idEmpresaUsuarioServer: idEmpresaUsuario
            }),
        })
            .then(function (resposta) {
                console.log("resposta: ", resposta);

                if (resposta.ok) {

                    if (resposta.status == 204) {
                        var lista = document.getElementById("dash-func");
                        var mensagem = document.createElement("span");
                        mensagem.innerHTML = "Nenhuma empresa encontrada."
                        lista.appendChild(mensagem);
                        throw "Nenhuma resultada encontrada!!";
                    }

                    resposta.json().then(function (resposta) {
                        console.log("Dados recebidos: ", JSON.stringify(resposta));

                        var lista = document.getElementById("dash-func");


                        for (let i = 0; i < resposta.length; i++) {

                            var tupla = resposta[i];
                            var divLista = document.createElement("div");
                            var divId = document.createElement("div");
                            var divnome = document.createElement("div");
                            var divEmail = document.createElement("div");
                            var divCargo = document.createElement("div");

                            divLista.className = "dados-func";
                            divId.className = "coluna-func";
                            divnome.className = "coluna-func";
                            divEmail.className = "coluna-func";
                            divCargo.className = "coluna-func";

                            divId.innerHTML = tupla.idUsuario;
                            divnome.innerHTML = tupla.nomeUsuario;
                            divEmail.innerHTML = tupla.emailUsuario;
                            divCargo.innerHTML = tupla.tipoPerfilUsuario;

                            divLista.appendChild(divId);
                            divLista.appendChild(divnome);
                            divLista.appendChild(divEmail);
                            divLista.appendChild(divCargo);
                            lista.appendChild(divLista);
                        }

                    });
                } else {
                    throw ('Houve um erro na API!');
                }
            }).catch(function (resposta) {
                console.error(resposta);
            });
    }

    function filtrarComum() {
        fetch("/usuarios/visualizarUsuariosCOMUM", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({
                idEmpresaUsuarioServer: idEmpresaUsuario
            }),
        })
            .then(function (resposta) {
                console.log("resposta: ", resposta);

                if (resposta.ok) {

                    if (resposta.status == 204) {
                        var lista = document.getElementById("dash-func");
                        var mensagem = document.createElement("span");
                        mensagem.innerHTML = "Nenhuma empresa encontrada."
                        lista.appendChild(mensagem);
                        throw "Nenhuma resultada encontrada!!";
                    }

                    resposta.json().then(function (resposta) {
                        console.log("Dados recebidos: ", JSON.stringify(resposta));

                        var lista = document.getElementById("dash-func");


                        for (let i = 0; i < resposta.length; i++) {

                            var tupla = resposta[i];
                            var divLista = document.createElement("div");
                            var divId = document.createElement("div");
                            var divnome = document.createElement("div");
                            var divEmail = document.createElement("div");
                            var divCargo = document.createElement("div");

                            divLista.className = "dados-func";
                            divId.className = "coluna-func";
                            divnome.className = "coluna-func";
                            divEmail.className = "coluna-func";
                            divCargo.className = "coluna-func";

                            divId.innerHTML = tupla.idUsuario;
                            divnome.innerHTML = tupla.nomeUsuario;
                            divEmail.innerHTML = tupla.emailUsuario;
                            divCargo.innerHTML = tupla.tipoPerfilUsuario;

                            divLista.appendChild(divId);
                            divLista.appendChild(divnome);
                            divLista.appendChild(divEmail);
                            divLista.appendChild(divCargo);
                            lista.appendChild(divLista);
                        }

                    });
                } else {
                    throw ('Houve um erro na API!');
                }
            }).catch(function (resposta) {
                console.error(resposta);
            });
    }


    function totalfunc() {
        console.log("Iniciando fetch para totalfunc...");
        fetch("/usuarios/totalfunc", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({
                idEmpresaUsuarioServer: idEmpresaUsuario
            }),
        }).then(function (resposta) {
            console.log("Resposta recebida: ", resposta);
            if (resposta.ok) {
                return resposta.json();
            } else {
                console.error('Erro na resposta:', resposta.statusText);
            }
        }).then(function (total) {
            console.log("Total de funcionários recebido: ", total);
            var totalfuncionarios = document.getElementById("totalfuncionarios");
            if (totalfuncionarios) {
                totalfuncionarios.textContent = total;
                console.log("Texto atualizado: ", totalfuncionarios.textContent);
            } else {
                console.error("Elemento 'totalfuncionarios' não encontrado!");
            }
        }).catch(function (erro) {
            console.error('Erro ao buscar dados:', erro);
        });
    }

    function totaladms() {
        console.log("Iniciando fetch para totaladms...");
        fetch("/usuarios/totaladms", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({
                idEmpresaUsuarioServer: idEmpresaUsuario
            }),
        }).then(function (resposta) {
            console.log("Resposta recebida: ", resposta);
            if (resposta.ok) {
                return resposta.json();
            } else {
                console.error('Erro na resposta:', resposta.statusText);
            }
        }).then(function (total) {
            console.log("Total de administradores recebido: ", total);
            var totalADM = document.getElementById("totaladms");
            if (totalADM) {
                totalADM.textContent = total;
                console.log("Texto atualizado: ", totalADM.textContent);
            } else {
                console.error("Elemento 'totaladms' não encontrado!");
            }
        }).catch(function (erro) {
            console.error('Erro ao buscar dados:', erro);
        });
    }

    function totalanalista() {
        console.log("Iniciando fetch para totalanalista...");
        fetch("/usuarios/totalanalista", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({
                idEmpresaUsuarioServer: idEmpresaUsuario
            }),
        }).then(function (resposta) {
            console.log("Resposta recebida: ", resposta);
            if (resposta.ok) {
                return resposta.json();
            } else {
                console.error('Erro na resposta:', resposta.statusText);
            }
        }).then(function (total) {
            console.log("Total de analistas recebido: ", total);
            var totalAnalista = document.getElementById("totalanalista");
            if (totalAnalista) {
                totalAnalista.textContent = total;
                console.log("Texto atualizado: ", totalAnalista.textContent);
            } else {
                console.error("Elemento 'totalanalista' não encontrado!");
            }
        }).catch(function (erro) {
            console.error('Erro ao buscar dados:', erro);
        });
    }

    function gerenciarUsuario(idUsuarioSelecionado) {
        // Exibe o ID do usuário para confirmação
        alert("ID do usuário selecionado: " + idUsuarioSelecionado);
        idUsuario = idUsuarioSelecionado;
        fetch("/usuarios/exibirDadosEdicaoUsuario", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({
                idUsuarioServer: idUsuarioSelecionado,
            }),
        })
            .then(function (resposta) {
                if (resposta.ok) {
                    resposta.json().then(function (json) {
                        let nomeUsuarioEdicao = json.nomeUsuario;
                        let emailUsuarioEdicao = json.emailUsuario;
                        let senhaUsuarioEdicao = json.senhaUsuario;
                        let cargoUsuarioEdicao = json.tipoPerfilUsuario;

                        document.getElementById("input_alterar_nome").value = nomeUsuarioEdicao;
                        document.getElementById("input_alterar_email").value = emailUsuarioEdicao;
                        document.getElementById("input_alterar_senha").value = senhaUsuarioEdicao;

                        let selectCargo = document.getElementById("select_alterar_cargo");
                        for (let option of selectCargo.options) {
                            if (option.value === cargoUsuarioEdicao) {
                                option.selected = true;
                                break;
                            }
                        }

                        document.querySelector('.mainfuncpage').style.filter = "blur(5px)";
                        document.querySelector('.Editarfunc').style.display = "block";
                    });
                } else {
                    console.error("Houve um erro na requisição");
                }
            })
            .catch(function (erro) {
                console.error("Erro ao tentar buscar os dados do usuário:", erro);
            });

        return false;
    }


    function deletarUsuario() {
        // Exibe o ID do usuário para confirmação
        alert("ID do usuário selecionado: " + idUsuario);

        fetch("/usuarios/deletarusuario", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({
                idUsuarioServer: idUsuario,
            }),
        })
            .then(function (resposta) {
                if (resposta.ok) {
                    resposta.json().then(function (json) {
                        console.log("Usuário deletado com sucesso:", json);
                        verUsuarios();
                    });
                } else {
                    console.error("Houve um erro na requisição");
                }
            })
            .catch(function (erro) {
                console.error("Erro ao tentar deletar o usuário:", erro);
            });

        return false;
    }


    function editarusuario() {
        var nome = document.getElementById("input_alterar_nome").value;
        var email = document.getElementById("input_alterar_email").value;
        var senha = document.getElementById("input_alterar_senha").value;
        var cargo = document.getElementById("select_alterar_cargo").value;

        console.log("Dados a serem enviados:", {
            idUsuarioServer: idUsuario,
            nomeUsuario: nome,
            emailUsuario: email,
            senhaUsuario: senha,
            tipoPerfilUsuario: cargo
        });

        fetch("/usuarios/editarusuario", {
            method: "POST",
            headers: {
                "Content-Type": "application/json",
            },
            body: JSON.stringify({
                idUsuarioServer: idUsuario,
                nomeUsuario: nome,
                emailUsuario: email,
                senhaUsuario: senha,
                tipoPerfilUsuario: cargo,
            }),
        })
            .then(function (resposta) {
                console.log("Status da resposta:", resposta.status);
                if (resposta.ok) {
                    resposta.json().then(function (json) {
                        console.log("Usuário atualizado com sucesso:", json);
                        alert("Perfil alterado com sucesso!");
                        window.location.reload(true);
                    });
                } else {
                    resposta.text().then(function (texto) {
                        console.error("Erro na resposta:", texto);
                    });
                }
            })
            .catch(function (erro) {
                console.error("Erro ao tentar alterar os dados do usuário:", erro);
            });
    }

    function cadastrarUsuario() {

        var nomeUsuarioVar = input_nome_func.value;
        var emailUsuarioVar = input_email_func.value;
        var senhaUsuarioVar = input_senha_func.value;
        var empresaUsuarioVar = idEmpresaUsuario;
        var tipoUsuarioVar = lista_cargo.value;


        // Verificando se há algum campo em branco
        if (
            nomeUsuarioVar == "" ||
            emailUsuarioVar == "" ||
            senhaUsuarioVar == "" ||
            senhaUsuarioVar != input_repetir_func.value
        ) {
            alert("Todos os campos dever ser preenchidos!")
            return false;
        } else {

            fetch("/usuarios/cadastrar", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json",
                },
                body: JSON.stringify({

                    nomeUsuarioServer: nomeUsuarioVar,
                    emailUsuarioServer: emailUsuarioVar,
                    senhaUsuarioServer: senhaUsuarioVar,
                    empresaUsuarioServer: empresaUsuarioVar,
                    tipoUsuariosServer: tipoUsuarioVar

                }),
            })
                .then(function (resposta) {
                    console.log("resposta: ", resposta);

                    if (resposta.ok) {

                        alert("CADASTRO EXECUTADO!")

                    } else {
                        throw "Houve um erro ao tentar realizar o cadastro!";
                    }
                })
                .catch(function (resposta) {
                    console.log(`#ERRO: ${resposta}`);

                });

            return false;
        }
    }



</script>